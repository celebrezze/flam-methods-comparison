---
title: "Metadata"
author: "Joe Celebrezze"
date: "2023-01-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(here)
here = here::here
library(tidyverse)
```

This .Rmd file covers the necessary metadata for the datasets that we used in the analyses for this manuscript.

# Raw Data

## lit.review.csv
```{r}
lit.review <- read_csv(here("raw-data", "lit.review.csv"))
head(lit.review)
```

*author*: author(s) of the given study, et al denotes that there were more than two authors, in which the first author was named prior to et al

*year*: publishing year of the given study

*sample.size.description*: notes taken on the sample size used in the flammability tests; if NA, then no information was provided; this was used to inform the next four columns

*sample.weight*: average weight of flammability samples in grams; if NA, then no information was provided

*sample.length.cm*: average length of flammability samples in cm; if NA, then no information was provided

*sample.area.cm*: average area of flammability samples in cm^2; if NA, then no information was provided

*sample.volume.cm*: average volume of flammability samples in cm^3; if NA, then no information was provided

**Methods Columns**: the following 16 columns -- *epiradiator*, *wind.tunnel*, *muffle.furnace*, *MLC*, *xylene.lattice*, *fire.bench*, *grill*, *oxygen.bomb.calorimeter*, *steel.ring.litter.bed*, *tray*, *FFB*, *FPA*, *cone.calorimeter*, *bunsen.burner*, *other*, *intermediate.scale.calorimeter* -- were formatted in the same way where they were given a binary identifier of 1 or 0, 1 denoting that the study used this specific method and 0 denoting that thy did not. The dataset was organized so that there was only 1 method used per row, so in cases where multiple methods were used by one study, then multiple rows were assigned for methods characterization (see *duplicate*). For in-depth descriptions of methods, see the table located in the appendix (Table A1).

*duplicate*: assigned a binary identifier of N (no) or Y (yes) denoting whether or not multple methods were used in the same study

*model*: a character vector assigned to the method used in the row where the following abbreviations were used matching up to the list of columns above in **Methods Columns** -- EPI, WT, MF, MLC, XL, FB, grill, OB, SR, tray, FFB, FPA, CC, BB, other, ISC

*notes*: any extra notes taken on the methods used in the study -- often for somewhat unique changes to methods or for 'other' methods

## lit.review.locations.csv
```{r}
lit.review.locations <- read_csv(here("raw-data", "lit.review.locations.csv"))
head(lit.review.locations)
```

*study*: identifier of the study using the author(s) and publishing year, NA values are for instances where multiplee locations were provided for the same study, in which the numerical id (see below) can adequately cross-reference the location data to the correct study

*id*: numerical identifier of the study, where the studies were ordered in alphabetical order of the last name of the first author. There are certain gaps in id's for instances where studies did not include any information on locations

*latitude*: latitude of the study location in decimal degrees (DD)

*longitude*: longitude of the study location in decimal degrees (DD)

*location notes*: notes taken on the study location(s). This can give a sense of whether or not the latitude and longitude reported are specific or if they are relatively broad.

## local_flam_data_all.csv
```{r}
local_flam_data_all <- read_csv(here("raw-data", "local_flam_data_all.csv"))
head(local_flam_data_all)
```

*individual*: an identifier for the individual which includes the date (YYYY_month), species (CEME = *Ceanothus megacarpus* and ADFA = *Adenostoma fasciculatum*) and a identification number for the individual

*sample*: the identification number for the individual

*round*: this describes the order in which the samples were burned over the course of a laboratory drydown (i.e., round = 1 means the first sample of that particular individual that we burned)

*spp*: an abbreviation for the species tested (CEME = *Ceanothus megacarpus* and ADFA = *Adenostoma fasciculatum*)

*model*: an identifier of the method used (EPI = epiradiator and HP = hot plate)

*mpa*: water potential (-MPa), reported here as a positive number but changed to negative values in the data wrangling step

*lfm*: live fuel moisture (LFM, %), as measured using Eq. 1 reported in the paper

*lfm_notes*: any notes taken on the live fuel moisture sample

*fh*: the maximum flame height (cm) observed during combustion

*ttfg*: time to first glow (seconds); time elapsed between loading the sample into the flammability chamber and the beginning of the glow time

*gti*: glow to ignition (seconds); time elapsed between beginning of glow time and the time which ignition occurred

*tti*: time to ignition (seconds); time elapsed between loading the sample into the flammability chamber and the time which ignition occurred

*fd*: flame duration (seconds); duration of the combustion from ignition to extinction of the flame

*gd*: glow duration (seconds); time elapsed between beginning and end of glow time

*pfg*: post-flame glow (seconds); time elapsed between extinction of flame (end of comubstion) and end of glow time

*ignition*: binary identifier describing whether or not the sample ignited (1 = ignited, 0 = not ignited)

*start_temp*: starting temperature (degrees Celsius)...

*temp_max*: maximum temperature (degrees Celsius)...

*ignition_temp*: temperature (degrees Celsius) at the point of ignition

*prop_new*: estimated proportion of new growth in the sample as observed directly prior to loaading the sample in the flammability chamber

*sample_wt*: weight (g) of the sample loaded into the flammability chamber

*glow*: binary identifier describing whether or not the sample glowed (1 = glowed, 0 = did not glow)

*year_month*: identifier of date when we ran flammability tests in format YYYY_Month (e.g., 2023_January)

*year*: identifier of year when we ran flammability tests in format YYYY

*month*: identifier of month, written out with a capital letter to start, when we ran flammability tests

*dry_wt*: the weight (g) after oven-drying for 24hr at 100C from the subsample used to measure live fuel moisture

*fresh_wt*: the weight (g) of the subsample used to measure live fuel moisture prior to oven-drying

*water_wt*: the difference between the *fresh_wt* and the *dry_wt* representing the weight of water (g) in the LFM subsample

*site*: a character identifier describing the site that we gathered the samples from (either St. Marys = chapparal Site 1 = 34.4613N, -119.6934W or Painted Caves = chapparal Site 2 = 34.4931N, -119.7910W)

*lfm_outliers_out*: a column reporting LFM values, with outliers replaced with NAs

*lfm_n_as_imputed*: a column reporting LFM values, with NAs replaced by imputing the predicted LFM value at that water potential

*gr*: represents the 10% bin of LFM that the sample fell into (e.g., (90,100] = the sample's LFM was greater than 90% and less than or equal to 100%)

*precip_2month*: duplicate column of year_month - REMOVE

*precip_2mo*: the precipitation (cm??) recorded by local weather stations (where??) for the 2 months prior to flammability testing

*season*: an identifier of whether or not sampling efforts occurred after (season = Wet) the beginning of seasonal rains (typically in the late fall to spring) or before (season = Dry) seasonal rains (typically late spring or early summer to late fall)

*hydration*: an identifier denoting the hydration status of the sample based on LFM and water potential measurements, split into "dry", "moderate", and "hydrated"

*bins5lfm*: represents the 5% bin of LFM that the sample fell into

*bins10lfm*: duplicate column of gr - REMOVE or remove *gr*

*bins20lfm*: represents the 20% bin of LFM that the sample fell into

*temp_change*: the difference in temperature (degrees C) from the starting temperature to the maximum temperature (i.e., *temp_max* - *start_temp*)

*gdw_gfw*: REMOVE?

*gww_gdw*: REMOVE? 

*flam_index*: REMOVE?

*max_mpa_sample*: REMOVE?

## SEKI_flammability.csv
```{r}
SEKI_flammability <- read_csv(here("raw-data", "SEKI_flammability.csv"))
head(SEKI_flammability)
```

Many of the following columns are identical to the columns described above, so I will only be providing extra information as necessary, otherwise, see the column descriptions for local_flam_data_all.csv

*sample*: an identifier of the individual using the following format, site.individual (i.e., 2.1 = site 2, individual 1 (at that site))

*round*: see above

*spp*: abbreviations of study species as follows: ARPA = *Arctostaphylos patula*, ABCO = *Abies concolor*, CADE = *Calocedrus decurrens*, CECO = *Ceanothus cordulatus*, PIJE = *Pinus jeffreyii*, and QUKE = *Quercus kelloggii*; note that only ARPA and CECO were seriously considered in this study due to the other four species having very few ignitions (primarily due to our epiradiator breaking during testing, rather than a low ignition percentage)

*model*: see above

*mpa*: water potential (MPa) as a negative value (which is the correct representation of water potential)

*lfm*: see above

*lfm.notes*: see above lfm_notes

**Flammability Metrics**: *fh*, *ttfg*, *gti*, *tti*, *fd*, *gd*, *pfg*, *ignition*, *start.temp* (see *start_temp*), *temp.max* (see *temp_max*), *ignition.temp* (see *ignition_temp*), *prop.new* (see *prop_new*), *sample.wt* (see *sample_wt*), and *glow* are all identical to what was reported above for local_flam_data_all.csv

*year* and *month*: see above

*dry.wt*, *fresh.wt*, and *water.wt*: see *dry_wt*, *fresh_wt* and *water_wt* above and note *bottle.wt* below

*site*: numerical identifier of sampling site (input coordinates here!)

*bottle.wt*: the weight of the tin (g) in which we weighed all measurements for LFM measurements. Note that the *dry.wt* and *fresh.wt* columns include the weight of the tin as well as the weight of the sample in every case which differs from local_flam_data_all where the *dry_wt* and *fresh_wt* have the bottle subtracted from the weight

*ttms*: time elapsed from beginning of ignition to the point where the entire sample is engulfed in flames (seconds); note that we did not end up using this, as -- especially for the epiradiator burns -- we deemed it to be too subjective and inconsistent of a metric to reliably use in analyses

## pv_summary_df_timing.csv
```{r}
pv_summary_df_timing <- read_csv(here("raw-data", "pv_summary_df_timing.csv"))
head(pv_summary_df_timing)
```

Although we did not end up using pressure-volume curve data in any of the analyses reported in the paper or the supplementary index, we did use it in some exploratory/extra analyses looking at whether or not we could detect thresholds in flammability metrics at or around the identified turgor loss point for species; therefore, it is in the GitHub repository.

Pressure-volume curves (PV curves) were conducted using the protocols outlined in Tyree & Hammel 1972 as described below (from Boving et. al., *in review*): MAYBE CHANGE UP WORDING OF THESE PROTOCOLS?

Healthy 20-40 cm branches were collected from the 6 individuals from Site 1 (for either chaparral or SEKI species) shortly after dawn, sealed in moistened plastic bags, and transported to the laboratory in a cooler. Samples were either immediately processed within 1 hour of sample collection or stored in a refrigerator at 4C between processing (maximally 12 hours after collection). For processing, we cut branches incrementally underwater into smaller branchlets and rehydrated them in cool darkness for 2-4 hours, after which we excised healthy non-necrotic leaves or small leafy shoots from the branch using a razor blade. To avoid the effects of oversaturation, leaves and stems that had been underwater during rehydration were avoided during PV curve analysis. For *Pinus jeffreyi* fascicles were rehydrated by placing the entire excised fascicle in water.

Water potential (-MPa) and leaf weight (to 0.0001 g) were determined on 3-6 rehydrated leaves or branchlets (1 per individual). While measuring water potential, care was taken to slowly increase pressure (0.1 -Mpa/sec) for accurate water potential estimates, and to slowly remove pressure from the tank following measurements to avoid rapid cooling of the sample. Consecutive water potential and weight measurements were taken on each leaf and plotted as -1/MPa and sample weight. This plot informed when we had reached the TLP, and we ceased measurements after three to five points of the linear section of the curve were reached. We determined saturated water content by extrapolating the plot of water potential and water weight to water potential = 0, which was used to determine relative water content (RWC) and LFM using Eq. 1. The LFM, RWC, and water potential at TLP corresponded with the point at which the exponential section of the curve met the linear section, determined by maximizing the linear fit (R2) of the tail of the curve. The osmotic potential at full turgor was calculated as the y-intercept of the linear section of the curve. PV parameters were determined using the protocols available on prometheus wiki.

*spp*: a species identifier following these abbreviations: ARPA = *Arctostaphylos patula*, ABCO = *Abies concolor*, CADE = *Calocedrus decurrens*, CECO = *Ceanothus cordulatus*, PIJE = *Pinus jeffreyii*, QUKE = *Quercus kelloggii*, CEME = *Ceanothus megacarpus*, and ADFA = *Adenostoma fasciculatum*

*timing*: the season that the PV curves were completed

*mean_tlp*: the average of the turgor loss point (TLP) across individuals tested (MPa)

*lwr*: the lower bounds of the TLP (MPa) as identified using...

*upr*: the upper bounds of the TLP (MPa) as identified using..

*mean_lfm*: the average of the TLP across individuals tested expressed as live fuel moisture (%); note that we did not do this for spring PV curves

*lwr_lfm*: the lower bounds of the TLP (LFM, %) as identified using...

*upr_lfm*: the upper bounds of the TLP (LFM, %) as identified using..

# Processed Data

## seki_flam_data_all.csv
```{r}
seki_flam_data_all <- read_csv(here("processed-data", "seki_flam_data_all.csv"))
head(seki_flam_data_all)
```


## all_ignite_only_bothmethods_bothlocations.csv
```{r}
all_ignite_only_bothmethods_bothlocations <- read_csv(here("processed-data", "all_ignite_only_bothmethods_bothlocations.csv"))
head(all_ignite_only_bothmethods_bothlocations)
```

This dataset was one of the seven created in 1.data_wrangling_methods.Rmd as a combination of local_flam_data_all.csv and seki_flam_data_all.csv

## bothm_bothl_manual_ignitions_in.csv
```{r}
bothm_bothl_manual_ignitions_in <- read_csv(here("processed-data", "bothm_bothl_manual_ignitions_in.csv"))
head(bothm_bothl_manual_ignitions_in)
```

This dataset was one of the seven created in 1.data_wrangling_methods.Rmd as a combination of local_flam_data_all.csv and seki_flam_data_all.csv

## bothmethods_and_locations_long_noignitionsincluded.csv
```{r}
bothmethods_and_locations_long_noignitionsincluded <- read_csv(here("processed-data", "bothmethods_and_locations_long_noignitionsincluded.csv"))
head(bothmethods_and_locations_long_noignitionsincluded)
```

This dataset was one of the seven created in 1.data_wrangling_methods.Rmd as a combination of local_flam_data_all.csv and seki_flam_data_all.csv

## bothmethods_and_locations_wide_noignitionsincluded.csv
```{r}
bothmethods_and_locations_wide_noignitionsincluded <- read_csv(here("processed-data", "bothmethods_and_locations_wide_noignitionsincluded.csv"))
head(bothmethods_and_locations_wide_noignitionsincluded)
```

This dataset was one of the seven created in 1.data_wrangling_methods.Rmd as a combination of local_flam_data_all.csv and seki_flam_data_all.csv

## bothmethods_bothlocations_wide.csv
```{r}
bothmethods_bothlocations_wide <- read_csv(here("processed-data", "bothmethods_bothlocations_wide.csv"))
head(bothmethods_bothlocations_wide)
```

This dataset was one of the seven created in 1.data_wrangling_methods.Rmd as a combination of local_flam_data_all.csv both seki_flam_data_all.csv

## bothmethods_bothlocations_long.csv
```{r}
bothmethods_bothlocations_long <- read_csv(here("processed-data", "bothmethods_bothlocations_long.csv"))
head(bothmethods_bothlocations_long)
```

This dataset was one of the seven created in 1.data_wrangling_methods.Rmd as a combination of local_flam_data_all.csv and seki_flam_data_all.csv

## bothmethods_bothlocations.csv
```{r}
bothmethods_bothlocations <- read_csv(here("processed-data", "bothmethods_bothlocations.csv"))
head(bothmethods_bothlocations)
```

This dataset was one of the seven created in 1.data_wrangling_methods.Rmd as a combination of local_flam_data_all.csv and seki_flam_data_all.csv
